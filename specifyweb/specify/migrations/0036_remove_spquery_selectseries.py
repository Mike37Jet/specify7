# Generated by Django 4.2.18 on 2025-06-04 16:59

from django.db import migrations, connection


def add_field_if_not_exists(apps, schema_editor):
    with connection.cursor() as cursor:
        cursor.execute("SELECT 1 FROM information_schema.columns WHERE table_name = 'spquery' AND column_name = 'selectseries';")
        if not cursor.fetchone():
            # Create the selectseries field in the spquery temporary table so the RemoveField migration doesn't fail in special cases
            cursor.execute("ALTER TABLE specify_spquery ADD COLUMN selectseries INTEGER NULL;")

class Migration(migrations.Migration):

    dependencies = [
        ('specify', '0035_version_required'),
    ]

    operations = [
        migrations.RunPython(add_field_if_not_exists, reverse_code=migrations.RunPython.noop),
        migrations.RemoveField(
            model_name='spquery',
            name='selectseries',
        ),
    ]
